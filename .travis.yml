os:
  - linux
  - osx

sudo: required
dist: trusty  
  
language: node_js

node_js:
  - '6'

before_deploy:
  - "npm install -g npm-run" 
  - "node node_modules/jsreport --init"
  - "npm-run jsreport-compile"
  - "tar -czvf jsreport-$TRAVIS_OS_NAME.tar.gz jsreport"
  - "npm install phantomjs-exact-2-1-1"
  - "env phantom:defaultPhantomjsVersion=2.1.1 npm-run jsreport-compile"
  - "tar -czvf jsreport-$TRAVIS_OS_NAME-ph2.tar.gz jsreport"

addons:
  apt:
    sources:
    - ubuntu-toolchain-r-test
    - llvm-toolchain-precise-3.6
    packages:
    - gcc-5
    - g++-5
    - clang-3.6

deploy:
  provider: releases
  skip_cleanup: true
  api_key:
    secure: TlV2eBd3M16e1LmsBR+8H982L1z2Hn5LghbgpwkIvxxBfjo7uuMYSwoL0ihY36Q7nGMYWvCUNn3tPZCeGolXQOdKbwOggjDMpk23rKpTj7D5IL/84Izcz0iQpugi0CZe4OcmoitLIa9h/2x9oGUJAbdmqQawGdHkuASa25tb+h4=
  file:
    - jsreport-$TRAVIS_OS_NAME.tar.gz
    - jsreport-$TRAVIS_OS_NAME-ph2.tar.gz
  on:
    tags: true
